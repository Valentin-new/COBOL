 IDENTIFICATION DIVISION.
 PROGRAM-ID. ValidarTarjeta.
 DATA DIVISION.
 WORKING-STORAGE SECTION.
 01 TARJETA PIC X(16) VALUE SPACES.
 01 INDICE PIC 9(2) VALUE 1.
 01 SUMA PIC 9(10) VALUE 0.
 01 DIGITO PIC 9 VALUE 0.
 01 MULTIPLO PIC 9 VALUE 0.
 01 VALIDA PIC X VALUE 'N'.
 PROCEDURE DIVISION.
 DISPLAY "Ingrese el número de tarjeta: ".
 ACCEPT TARJETA.
 PERFORM VALIDAR-LUHN
 IF VALIDA = 'S' THEN
 DISPLAY "El número de tarjeta es válido."
 ELSE
 DISPLAY "El número de tarjeta no es válido."
 END-IF.
 STOP RUN.
 VALIDAR-LUHN.
 MOVE 0 TO SUMA
 PERFORM VARYING INDICE FROM LENGTH OF TARJETA BY -1 UNTIL INDICE = 0
 COMPUTE DIGITO = FUNCTION NUMVAL-C(TARJETA(INDICE:1))
 IF LENGTH OF TARJETA - INDICE + 1 MOD 2 = 0 THEN
 COMPUTE MULTIPLO = DIGITO * 2
 IF MULTIPLO > 9 THEN
 SUBTRACT 9 FROM MULTIPLO
 END-IF
 ADD MULTIPLO TO SUMA
 ELSE
 ADD DIGITO TO SUMA
 END-IF
 END-PERFORM.
 IF SUMA MOD 10 = 0 THEN
 MOVE 'S' TO VALIDA
 ELSE
 MOVE 'N' TO VALIDA
 END-IF.
 EXIT.
